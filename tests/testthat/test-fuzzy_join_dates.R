
test_that("extraction_date must be date", {
  r_dt <- as.Date(c("2016-06-23", "2016-03-24", "2015-12-24", "2015-09-24", "2015-06-25",
                    "2015-03-26", "2014-12-25", "2014-09-25", "2014-06-26", "2014-03-27",
                    "2013-12-26", "2013-09-26", "2021-06-24", "2021-03-25", "2020-12-24",
                    "2020-09-24", "2020-06-25", "2020-03-26", "2019-12-26", "2019-09-26",
                    "2019-06-27", "2019-03-28", "2018-12-27", "2018-09-27"))
  e_dt <- c("2016-08-09", "2021-08-10")
  n_qtr = 4

  expect_error(
    fuzzy_join_dates(
      e_dt,
      r_dt,
      n = 3 * n_qtr,
      len_hist = (n_qtr + 1) * 12
    ),
    regexp = "e_dt must be of class Date",
    fixed = TRUE
  )
})

test_that("release_date must be date", {
  r_dt <- c("2016-06-23", "2016-03-24", "2015-12-24", "2015-09-24", "2015-06-25",
                    "2015-03-26", "2014-12-25", "2014-09-25", "2014-06-26", "2014-03-27",
                    "2013-12-26", "2013-09-26", "2021-06-24", "2021-03-25", "2020-12-24",
                    "2020-09-24", "2020-06-25", "2020-03-26", "2019-12-26", "2019-09-26",
                    "2019-06-27", "2019-03-28", "2018-12-27", "2018-09-27")
  e_dt <- as.Date(c("2016-08-09", "2021-08-10"))
  n_qtr = 4

  expect_error(
    fuzzy_join_dates(
      e_dt,
      r_dt,
      n = 3 * n_qtr,
      len_hist = (n_qtr + 1) * 12
    ),
    regexp = "r_dt must be of class Date",
    fixed = TRUE
  )
})
